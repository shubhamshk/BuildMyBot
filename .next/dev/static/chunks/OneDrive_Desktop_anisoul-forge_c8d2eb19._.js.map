{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/shubh/OneDrive/Desktop/anisoul-forge/components/api-key-modal.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { X, Key, CheckCircle2 } from \"lucide-react\";\r\nimport { createClient } from \"@/lib/supabase/client\";\r\n\r\ninterface APIKeyModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSave: () => void;\r\n}\r\n\r\nconst PROVIDERS = [\r\n  { value: \"openai\", label: \"OpenAI\", placeholder: \"sk-...\" },\r\n  { value: \"gemini\", label: \"Google Gemini\", placeholder: \"AIza...\" },\r\n  { value: \"openrouter\", label: \"OpenRouter\", placeholder: \"sk-or-...\" },\r\n  { value: \"huggingface\", label: \"HuggingFace\", placeholder: \"hf_...\" },\r\n];\r\n\r\nexport function APIKeyModal({ isOpen, onClose, onSave }: APIKeyModalProps) {\r\n  const [selectedProvider, setSelectedProvider] = useState(\"openai\");\r\n  const [apiKey, setApiKey] = useState(\"\");\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      // Load existing key for selected provider if any\r\n      const stored = localStorage.getItem(`api_key_${selectedProvider}`);\r\n      if (stored) {\r\n        setApiKey(stored);\r\n      } else {\r\n        setApiKey(\"\");\r\n      }\r\n    }\r\n  }, [isOpen, selectedProvider]);\r\n\r\n  const handleSave = () => {\r\n    if (!apiKey.trim()) return;\r\n\r\n    setIsSaving(true);\r\n\r\n    // Store API key in localStorage\r\n    localStorage.setItem(`api_key_${selectedProvider}`, apiKey.trim());\r\n    localStorage.setItem(\"api_key_provider\", selectedProvider);\r\n    localStorage.setItem(\"api_key_connected\", \"true\");\r\n\r\n    // Small delay for UX\r\n    setTimeout(() => {\r\n      setIsSaving(false);\r\n      onSave();\r\n      onClose();\r\n    }, 300);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setApiKey(\"\");\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <>\r\n          {/* Backdrop */}\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={handleClose}\r\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50\"\r\n          />\r\n\r\n          {/* Modal */}\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none\">\r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              animate={{ opacity: 1, scale: 1, y: 0 }}\r\n              exit={{ opacity: 0, scale: 0.95, y: 20 }}\r\n              transition={{ duration: 0.2, ease: [0.22, 1, 0.36, 1] }}\r\n              onClick={(e) => e.stopPropagation()}\r\n              className=\"glass rounded-3xl p-8 max-w-md w-full border border-border pointer-events-auto\"\r\n            >\r\n              {/* Header */}\r\n              <div className=\"flex items-center justify-between mb-6\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"w-10 h-10 rounded-xl bg-violet-500/20 flex items-center justify-center\">\r\n                    <Key className=\"w-5 h-5 text-violet-400\" />\r\n                  </div>\r\n                  <div>\r\n                    <h2 className=\"text-xl font-semibold text-foreground\">\r\n                      API Key Required\r\n                    </h2>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      Enter your API key to generate content\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"w-8 h-8 rounded-lg glass border border-border hover:bg-white/5 transition-colors flex items-center justify-center\"\r\n                >\r\n                  <X className=\"w-4 h-4 text-foreground\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Provider Selection */}\r\n              <div className=\"mb-6\">\r\n                <label className=\"text-sm font-medium text-foreground mb-2 block\">\r\n                  AI Provider\r\n                </label>\r\n                <select\r\n                  value={selectedProvider}\r\n                  onChange={(e) => setSelectedProvider(e.target.value)}\r\n                  className=\"w-full h-12 px-4 rounded-xl glass border border-border focus:border-violet-500 transition-all outline-none appearance-none cursor-pointer bg-background\"\r\n                >\r\n                  {PROVIDERS.map((provider) => (\r\n                    <option key={provider.value} value={provider.value}>\r\n                      {provider.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {/* API Key Input */}\r\n              <div className=\"mb-6\">\r\n                <label className=\"text-sm font-medium text-foreground mb-2 block\">\r\n                  API Key\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  value={apiKey}\r\n                  onChange={(e) => setApiKey(e.target.value)}\r\n                  placeholder={PROVIDERS.find((p) => p.value === selectedProvider)?.placeholder}\r\n                  className=\"w-full h-12 px-4 rounded-xl glass border border-border focus:border-violet-500 transition-all outline-none font-mono text-sm\"\r\n                  autoFocus\r\n                />\r\n                <p className=\"text-xs text-muted-foreground mt-2\">\r\n                  Your API key is stored locally and never sent to our servers.\r\n                </p>\r\n              </div>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"flex-1 py-3 rounded-xl glass border border-border hover:bg-white/5 transition-colors font-medium\"\r\n                >\r\n                  Close\r\n                </button>\r\n                <button\r\n                  onClick={handleSave}\r\n                  disabled={!apiKey.trim() || isSaving}\r\n                  className=\"flex-1 py-3 rounded-xl bg-violet-500 hover:bg-violet-600 text-white font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n                >\r\n                  {isSaving ? (\r\n                    <>\r\n                      <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\r\n                      Saving...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <CheckCircle2 className=\"w-4 h-4\" />\r\n                      Save Key\r\n                    </>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 354, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/shubh/OneDrive/Desktop/anisoul-forge/lib/api-key.ts"],"sourcesContent":["/**\r\n * API Key management utilities\r\n * All keys stored in localStorage (frontend only)\r\n */\r\n\r\nexport type APIProvider = \"openai\" | \"gemini\" | \"openrouter\" | \"huggingface\";\r\n\r\nexport function getAPIKey(provider?: APIProvider): string | null {\r\n  const selectedProvider = provider || getSelectedProvider();\r\n  if (!selectedProvider) return null;\r\n  \r\n  return localStorage.getItem(`api_key_${selectedProvider}`);\r\n}\r\n\r\nexport function setAPIKey(provider: APIProvider, key: string): void {\r\n  localStorage.setItem(`api_key_${provider}`, key);\r\n  localStorage.setItem(\"api_key_provider\", provider);\r\n  localStorage.setItem(\"api_key_connected\", \"true\");\r\n}\r\n\r\nexport function getSelectedProvider(): APIProvider | null {\r\n  const provider = localStorage.getItem(\"api_key_provider\");\r\n  return provider as APIProvider | null;\r\n}\r\n\r\nexport function isAPIKeyConnected(): boolean {\r\n  return localStorage.getItem(\"api_key_connected\") === \"true\" && !!getAPIKey();\r\n}\r\n\r\nexport function clearAPIKey(): void {\r\n  const provider = getSelectedProvider();\r\n  if (provider) {\r\n    localStorage.removeItem(`api_key_${provider}`);\r\n  }\r\n  localStorage.removeItem(\"api_key_provider\");\r\n  localStorage.removeItem(\"api_key_connected\");\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;AAIM,SAAS,UAAU,QAAsB;IAC9C,MAAM,mBAAmB,YAAY;IACrC,IAAI,CAAC,kBAAkB,OAAO;IAE9B,OAAO,aAAa,OAAO,CAAC,CAAC,QAAQ,EAAE,kBAAkB;AAC3D;AAEO,SAAS,UAAU,QAAqB,EAAE,GAAW;IAC1D,aAAa,OAAO,CAAC,CAAC,QAAQ,EAAE,UAAU,EAAE;IAC5C,aAAa,OAAO,CAAC,oBAAoB;IACzC,aAAa,OAAO,CAAC,qBAAqB;AAC5C;AAEO,SAAS;IACd,MAAM,WAAW,aAAa,OAAO,CAAC;IACtC,OAAO;AACT;AAEO,SAAS;IACd,OAAO,aAAa,OAAO,CAAC,yBAAyB,UAAU,CAAC,CAAC;AACnE;AAEO,SAAS;IACd,MAAM,WAAW;IACjB,IAAI,UAAU;QACZ,aAAa,UAAU,CAAC,CAAC,QAAQ,EAAE,UAAU;IAC/C;IACA,aAAa,UAAU,CAAC;IACxB,aAAa,UAAU,CAAC;AAC1B"}},
    {"offset": {"line": 401, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/shubh/OneDrive/Desktop/anisoul-forge/lib/ai/providers.ts"],"sourcesContent":["export interface AIProvider {\r\n  generate(prompt: string, apiKey: string, model?: string): Promise<string>;\r\n}\r\n\r\n/**\r\n * Google Gemini AI Provider\r\n */\r\nexport class GeminiProvider implements AIProvider {\r\n  async generate(prompt: string, apiKey: string, model: string = \"gemini-pro\"): Promise<string> {\r\n    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;\r\n\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        contents: [\r\n          {\r\n            parts: [\r\n              {\r\n                text: prompt,\r\n              },\r\n            ],\r\n          },\r\n        ],\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.text();\r\n      throw new Error(`Gemini API error: ${error}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.candidates[0]?.content?.parts[0]?.text || \"\";\r\n  }\r\n}\r\n\r\n/**\r\n * OpenAI Provider\r\n */\r\nexport class OpenAIProvider implements AIProvider {\r\n  async generate(prompt: string, apiKey: string, model: string = \"gpt-4\"): Promise<string> {\r\n    // Handle system/user message split if prompt contains system instructions\r\n    let messages: Array<{ role: string; content: string }> = [];\r\n    \r\n    if (prompt.includes(\"CRITICAL RULES:\") || prompt.includes(\"You are an expert\")) {\r\n      // Split system and user prompts\r\n      const systemMatch = prompt.match(/^(.+?)(?=\\n\\nCHARACTER|CHARACTER BASICS|User-provided|Generate|Write)/s);\r\n      const systemPrompt = systemMatch ? systemMatch[1].trim() : \"\";\r\n      const userPrompt = systemMatch ? prompt.replace(systemMatch[1], \"\").trim() : prompt;\r\n      \r\n      if (systemPrompt) {\r\n        messages.push({ role: \"system\", content: systemPrompt });\r\n      }\r\n      messages.push({ role: \"user\", content: userPrompt });\r\n    } else {\r\n      messages.push({ role: \"user\", content: prompt });\r\n    }\r\n\r\n    // Determine API endpoint based on model\r\n    const isOpenRouter = model.includes(\"/\");\r\n    const apiUrl = isOpenRouter\r\n      ? \"https://openrouter.ai/api/v1/chat/completions\"\r\n      : \"https://api.openai.com/v1/chat/completions\";\r\n\r\n    const headers: Record<string, string> = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n\r\n    if (isOpenRouter) {\r\n      headers[\"Authorization\"] = `Bearer ${apiKey}`;\r\n      headers[\"HTTP-Referer\"] = typeof window !== \"undefined\" ? window.location.origin : \"\";\r\n      headers[\"X-Title\"] = \"AI Character Builder\";\r\n    } else {\r\n      headers[\"Authorization\"] = `Bearer ${apiKey}`;\r\n    }\r\n\r\n    const response = await fetch(apiUrl, {\r\n      method: \"POST\",\r\n      headers,\r\n      body: JSON.stringify({\r\n        model: isOpenRouter ? model : model,\r\n        messages,\r\n        temperature: 0.7,\r\n        max_tokens: 4000,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json().catch(() => ({ error: { message: \"Unknown error\" } }));\r\n      throw new Error(`API error: ${error.error?.message || \"Unknown error\"}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.choices[0]?.message?.content || \"\";\r\n  }\r\n}\r\n\r\n/**\r\n * Get AI provider based on model name\r\n */\r\nexport function getAIProvider(model: string): AIProvider {\r\n  if (model.startsWith(\"gpt-\") || model.startsWith(\"gpt4\")) {\r\n    return new OpenAIProvider();\r\n  }\r\n  if (model.startsWith(\"gemini-\") || model.includes(\"gemini\")) {\r\n    return new GeminiProvider();\r\n  }\r\n  // Default to Gemini\r\n  return new GeminiProvider();\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAOO,MAAM;IACX,MAAM,SAAS,MAAc,EAAE,MAAc,EAAE,QAAgB,YAAY,EAAmB;QAC5F,MAAM,MAAM,CAAC,wDAAwD,EAAE,MAAM,qBAAqB,EAAE,QAAQ;QAE5G,MAAM,WAAW,MAAM,MAAM,KAAK;YAChC,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,UAAU;oBACR;wBACE,OAAO;4BACL;gCACE,MAAM;4BACR;yBACD;oBACH;iBACD;YACH;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;YACjC,MAAM,IAAI,MAAM,CAAC,kBAAkB,EAAE,OAAO;QAC9C;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,KAAK,UAAU,CAAC,EAAE,EAAE,SAAS,KAAK,CAAC,EAAE,EAAE,QAAQ;IACxD;AACF;AAKO,MAAM;IACX,MAAM,SAAS,MAAc,EAAE,MAAc,EAAE,QAAgB,OAAO,EAAmB;QACvF,0EAA0E;QAC1E,IAAI,WAAqD,EAAE;QAE3D,IAAI,OAAO,QAAQ,CAAC,sBAAsB,OAAO,QAAQ,CAAC,sBAAsB;YAC9E,gCAAgC;YAChC,MAAM,cAAc,OAAO,KAAK,CAAC;YACjC,MAAM,eAAe,cAAc,WAAW,CAAC,EAAE,CAAC,IAAI,KAAK;YAC3D,MAAM,aAAa,cAAc,OAAO,OAAO,CAAC,WAAW,CAAC,EAAE,EAAE,IAAI,IAAI,KAAK;YAE7E,IAAI,cAAc;gBAChB,SAAS,IAAI,CAAC;oBAAE,MAAM;oBAAU,SAAS;gBAAa;YACxD;YACA,SAAS,IAAI,CAAC;gBAAE,MAAM;gBAAQ,SAAS;YAAW;QACpD,OAAO;YACL,SAAS,IAAI,CAAC;gBAAE,MAAM;gBAAQ,SAAS;YAAO;QAChD;QAEA,wCAAwC;QACxC,MAAM,eAAe,MAAM,QAAQ,CAAC;QACpC,MAAM,SAAS,eACX,kDACA;QAEJ,MAAM,UAAkC;YACtC,gBAAgB;QAClB;QAEA,IAAI,cAAc;YAChB,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,QAAQ;YAC7C,OAAO,CAAC,eAAe,GAAG,uCAAgC,OAAO,QAAQ,CAAC,MAAM,GAAG;YACnF,OAAO,CAAC,UAAU,GAAG;QACvB,OAAO;YACL,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,QAAQ;QAC/C;QAEA,MAAM,WAAW,MAAM,MAAM,QAAQ;YACnC,QAAQ;YACR;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO,eAAe,QAAQ;gBAC9B;gBACA,aAAa;gBACb,YAAY;YACd;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,QAAQ,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;oBAAE,OAAO;wBAAE,SAAS;oBAAgB;gBAAE,CAAC;YACxF,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,MAAM,KAAK,EAAE,WAAW,iBAAiB;QACzE;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,KAAK,OAAO,CAAC,EAAE,EAAE,SAAS,WAAW;IAC9C;AACF;AAKO,SAAS,cAAc,KAAa;IACzC,IAAI,MAAM,UAAU,CAAC,WAAW,MAAM,UAAU,CAAC,SAAS;QACxD,OAAO,IAAI;IACb;IACA,IAAI,MAAM,UAAU,CAAC,cAAc,MAAM,QAAQ,CAAC,WAAW;QAC3D,OAAO,IAAI;IACb;IACA,oBAAoB;IACpB,OAAO,IAAI;AACb"}},
    {"offset": {"line": 514, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/shubh/OneDrive/Desktop/anisoul-forge/lib/prompts/janitor-ai.ts"],"sourcesContent":["/**\r\n * Janitor AI format prompt builders\r\n * Follows exact template structure from Janitor AI Master Guide\r\n */\r\n\r\nimport { CharacterState } from \"@/context/CharacterContext\";\r\n\r\n/**\r\n * Normalize personality sliders into descriptive text\r\n */\r\nfunction normalizePersonality(personality: CharacterState[\"personality\"]): string {\r\n  const traits: string[] = [];\r\n\r\n  // Warmth\r\n  if (personality.warmth > 70) {\r\n    traits.push(\"warm, empathetic, and approachable\");\r\n  } else if (personality.warmth < 30) {\r\n    traits.push(\"reserved, stoic, and emotionally distant\");\r\n  } else {\r\n    traits.push(\"balanced in emotional warmth\");\r\n  }\r\n\r\n  // Confidence\r\n  if (personality.confidence > 70) {\r\n    traits.push(\"bold, assertive, and takes the lead\");\r\n  } else if (personality.confidence < 30) {\r\n    traits.push(\"shy, submissive, and prefers to follow\");\r\n  } else {\r\n    traits.push(\"moderately confident\");\r\n  }\r\n\r\n  // Calmness\r\n  if (personality.calmness > 70) {\r\n    traits.push(\"calm, predictable, and methodical\");\r\n  } else if (personality.calmness < 30) {\r\n    traits.push(\"chaotic, playful, and unpredictable\");\r\n  } else {\r\n    traits.push(\"balanced between calm and chaotic\");\r\n  }\r\n\r\n  // Reserve\r\n  if (personality.reserve > 70) {\r\n    traits.push(\"reserved, internal, and mysterious\");\r\n  } else if (personality.reserve < 30) {\r\n    traits.push(\"expressive, vibrant, and emotionally open\");\r\n  } else {\r\n    traits.push(\"moderately expressive\");\r\n  }\r\n\r\n  return traits.join(\", \");\r\n}\r\n\r\n/**\r\n * Build system prompt for Janitor AI personality generation\r\n */\r\nfunction buildPersonalitySystemPrompt(): string {\r\n  return `You are an expert Janitor AI bot creator. Your task is to create detailed, immersive character personalities following the EXACT Janitor AI format.\r\n\r\nCRITICAL RULES:\r\n- NEVER control {{user}} or speak for the user\r\n- Use third-person narration\r\n- Avoid negative instructions (say what they DO, not what they DON'T)\r\n- Permanent tokens should be concise but complete\r\n- Personality defines what is ALWAYS true\r\n- Dialogue examples are illustrative ONLY - do NOT use verbatim\r\n- Avoid excessive sexual detail in permanent tokens\r\n- Keep formatting EXACTLY as specified\r\n\r\nTEMPLATE STRUCTURE:\r\nYou must follow this EXACT format with all sections:\r\n\r\n<npcs>\r\n(50–100 word descriptions for NPCs if relevant)\r\n</npcs>\r\n\r\n<character_name>\r\nFull Name:\r\nAliases:\r\nSpecies:\r\nNationality:\r\nEthnicity:\r\nAge:\r\nOccupation/Role:\r\nAppearance:\r\nScent:\r\nClothing:\r\n\r\n[Backstory:\r\nConcise but complete backstory.\r\nUse bullet points for key events.]\r\n\r\nCurrent Residence:\r\n\r\n[Relationships:\r\nDescribe relationships.\r\nInclude one short in-character quote per relationship.]\r\n\r\n[Personality\r\nTraits:\r\nLikes:\r\nDislikes:\r\nInsecurities:\r\nPhysical behaviour:\r\nOpinions:]\r\n\r\n[Intimacy\r\nTurn-ons:\r\nDuring Sex:]\r\n\r\n[Dialogue\r\nAccent/tone rules.\r\n[These are merely examples of how CHARACTER NAME may speak and should NOT be used verbatim.]\r\nGreeting:\r\nSurprised:\r\nStressed:\r\nMemory:\r\nOpinion:]\r\n\r\n[Notes\r\nMisc traits, secrets, quirks]\r\n</character_name>\r\n\r\nIMPORTANT:\r\n- Fill ALL fields with appropriate content\r\n- Keep backstory concise but complete\r\n- Dialogue examples should be natural and varied\r\n- Never include placeholder text\r\n- Format must be preserved exactly`;\r\n}\r\n\r\n/**\r\n * Build user prompt for personality generation\r\n */\r\nexport function buildJanitorPersonalityPrompt(character: CharacterState): string {\r\n  const normalizedTraits = normalizePersonality(character.personality);\r\n  const backstoryStyle = character.backstoryStyle || \"Mysterious Past\";\r\n  const speechTone = character.speechRules?.tone || \"Casual & Warm\";\r\n  const speechVocab = character.speechRules?.vocabulary || \"Conversational\";\r\n  const contentRating = character.boundaries?.contentRating || \"SFW\";\r\n  const setting = character.basics.setting || \"Modern Day\";\r\n  const relationship = character.basics.relationship || \"Stranger\";\r\n\r\n  return `Create a complete Janitor AI personality profile for this character:\r\n\r\nCHARACTER BASICS:\r\n- Name: ${character.basics.name}\r\n- Age: ${character.basics.age}\r\n- Gender: ${character.basics.gender}\r\n- Setting: ${setting}\r\n- Relationship to user: ${relationship}\r\n\r\nPERSONALITY TRAITS:\r\n${normalizedTraits}\r\n\r\nBACKSTORY STYLE: ${backstoryStyle}\r\n\r\nSPEECH STYLE:\r\n- Tone: ${speechTone}\r\n- Vocabulary: ${speechVocab}\r\n${character.speechRules?.patterns ? `- Patterns: ${character.speechRules.patterns}` : \"\"}\r\n\r\nCONTENT RATING: ${contentRating}\r\n${character.boundaries?.topics ? `- Topics to avoid: ${character.boundaries.topics}` : \"\"}\r\n${character.boundaries?.tone ? `- Overall tone: ${character.boundaries.tone}` : \"\"}\r\n\r\nGenerate the complete personality profile following the EXACT template format provided.`;\r\n}\r\n\r\n/**\r\n * Build prompt for scenario generation\r\n */\r\nexport function buildScenarioPrompt(character: CharacterState, userScenario?: string): string {\r\n  const systemPrompt = `You are an expert Janitor AI bot creator. Create engaging scenarios that:\r\n- Define the world and situation\r\n- NEVER control {{user}} or speak for the user\r\n- Set up an immersive starting point\r\n- Align with the character's backstory and personality\r\n- Use third-person narration\r\n- Avoid lore dumps\r\n- Make the scenario scene-forward\r\n\r\nScenario should be 2-4 paragraphs, setting up where the character is, what's happening, and the initial situation.`;\r\n\r\n  const userPrompt = userScenario\r\n    ? `User-provided scenario idea: ${userScenario}\\n\\nRefine and expand this into a complete scenario following Janitor AI best practices.`\r\n    : `Generate a scenario for this character:\r\n\r\nCHARACTER:\r\n- Name: ${character.basics.name}\r\n- Setting: ${character.basics.setting}\r\n- Backstory Style: ${character.backstoryStyle || \"Mysterious Past\"}\r\n- Personality: ${normalizePersonality(character.personality)}\r\n- Relationship to user: ${character.basics.relationship}\r\n\r\nCreate an engaging scenario that sets up the initial situation and world.`;\r\n\r\n  return `${systemPrompt}\\n\\n${userPrompt}`;\r\n}\r\n\r\n/**\r\n * Build prompt for initial message generation\r\n */\r\nexport function buildInitialMessagePrompt(character: CharacterState, scenario?: string): string {\r\n  const systemPrompt = `You are an expert Janitor AI bot creator. Write the first message from the character that:\r\n- NEVER speaks or acts for {{user}}\r\n- Is NPC-driven (the character initiates)\r\n- Avoids lore dumps\r\n- Has no time skips\r\n- Is scene-forward (shows what's happening NOW)\r\n- Sets the tone naturally\r\n- Feels like a real first message\r\n\r\nThe message should be 2-4 sentences, showing the character in the moment.`;\r\n\r\n  const userPrompt = `Write the first message for:\r\n\r\nCHARACTER:\r\n- Name: ${character.basics.name}\r\n- Setting: ${character.basics.setting}\r\n- Personality: ${normalizePersonality(character.personality)}\r\n- Speech Tone: ${character.speechRules?.tone || \"Casual & Warm\"}\r\n- Speech Vocabulary: ${character.speechRules?.vocabulary || \"Conversational\"}\r\n${scenario ? `\\nSCENARIO:\\n${scenario}` : \"\"}\r\n\r\nGenerate the initial message that the character would send to start the conversation.`;\r\n\r\n  return `${systemPrompt}\\n\\n${userPrompt}`;\r\n}\r\n\r\n/**\r\n * Get system prompt for personality generation\r\n */\r\nexport function getPersonalitySystemPrompt(): string {\r\n  return buildPersonalitySystemPrompt();\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 731, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/shubh/OneDrive/Desktop/anisoul-forge/lib/generation/service.ts"],"sourcesContent":["/**\r\n * AI Generation Service\r\n * Handles all AI content generation with API key management\r\n */\r\n\r\nimport { CharacterState } from \"@/context/CharacterContext\";\r\nimport { getAPIKey, getSelectedProvider, APIProvider } from \"@/lib/api-key\";\r\nimport { OpenAIProvider, GeminiProvider } from \"@/lib/ai/providers\";\r\nimport {\r\n  buildJanitorPersonalityPrompt,\r\n  getPersonalitySystemPrompt,\r\n  buildScenarioPrompt,\r\n  buildInitialMessagePrompt,\r\n} from \"@/lib/prompts/janitor-ai\";\r\n\r\nexport interface GenerationState {\r\n  loading: boolean;\r\n  error: string | null;\r\n  content: string | null;\r\n}\r\n\r\nexport interface CharacterGenerationState {\r\n  personality: GenerationState;\r\n  scenario: GenerationState;\r\n  initialMessage: GenerationState;\r\n}\r\n\r\n/**\r\n * Get AI provider instance\r\n */\r\nfunction getProvider(provider: APIProvider): OpenAIProvider | GeminiProvider {\r\n  if (provider === \"openai\" || provider === \"openrouter\") {\r\n    return new OpenAIProvider();\r\n  }\r\n  return new GeminiProvider();\r\n}\r\n\r\n/**\r\n * Generate personality content in Janitor AI format\r\n */\r\nexport async function generatePersonality(\r\n  character: CharacterState,\r\n  apiKey: string,\r\n  provider: APIProvider\r\n): Promise<string> {\r\n  const systemPrompt = getPersonalitySystemPrompt();\r\n  const userPrompt = buildJanitorPersonalityPrompt(character);\r\n  \r\n  const aiProvider = getProvider(provider);\r\n  \r\n  // For OpenAI, use system/user messages\r\n  if (provider === \"openai\" || provider === \"openrouter\") {\r\n    const fullPrompt = `${systemPrompt}\\n\\n${userPrompt}`;\r\n    return await aiProvider.generate(fullPrompt, apiKey, provider === \"openrouter\" ? \"openai/gpt-4\" : \"gpt-4\");\r\n  }\r\n  \r\n  // For Gemini, combine into single prompt\r\n  const fullPrompt = `${systemPrompt}\\n\\n${userPrompt}`;\r\n  return await aiProvider.generate(fullPrompt, apiKey, \"gemini-pro\");\r\n}\r\n\r\n/**\r\n * Generate scenario\r\n */\r\nexport async function generateScenario(\r\n  character: CharacterState,\r\n  userScenario: string | undefined,\r\n  apiKey: string,\r\n  provider: APIProvider\r\n): Promise<string> {\r\n  const prompt = buildScenarioPrompt(character, userScenario);\r\n  const aiProvider = getProvider(provider);\r\n  \r\n  if (provider === \"openai\" || provider === \"openrouter\") {\r\n    return await aiProvider.generate(prompt, apiKey, provider === \"openrouter\" ? \"openai/gpt-4\" : \"gpt-4\");\r\n  }\r\n  \r\n  return await aiProvider.generate(prompt, apiKey, \"gemini-pro\");\r\n}\r\n\r\n/**\r\n * Generate initial message\r\n */\r\nexport async function generateInitialMessage(\r\n  character: CharacterState,\r\n  scenario: string | undefined,\r\n  apiKey: string,\r\n  provider: APIProvider\r\n): Promise<string> {\r\n  const prompt = buildInitialMessagePrompt(character, scenario);\r\n  const aiProvider = getProvider(provider);\r\n  \r\n  if (provider === \"openai\" || provider === \"openrouter\") {\r\n    return await aiProvider.generate(prompt, apiKey, provider === \"openrouter\" ? \"openai/gpt-4\" : \"gpt-4\");\r\n  }\r\n  \r\n  return await aiProvider.generate(prompt, apiKey, \"gemini-pro\");\r\n}\r\n\r\n/**\r\n * Validate API key exists\r\n */\r\nexport function validateAPIKey(): { valid: boolean; apiKey: string | null; provider: APIProvider | null } {\r\n  const provider = getSelectedProvider();\r\n  if (!provider) {\r\n    return { valid: false, apiKey: null, provider: null };\r\n  }\r\n  \r\n  const apiKey = getAPIKey(provider);\r\n  if (!apiKey) {\r\n    return { valid: false, apiKey: null, provider: null };\r\n  }\r\n  \r\n  return { valid: true, apiKey, provider };\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;AAGD;AACA;AACA;;;;AAmBA;;CAEC,GACD,SAAS,YAAY,QAAqB;IACxC,IAAI,aAAa,YAAY,aAAa,cAAc;QACtD,OAAO,IAAI,sLAAc;IAC3B;IACA,OAAO,IAAI,sLAAc;AAC3B;AAKO,eAAe,oBACpB,SAAyB,EACzB,MAAc,EACd,QAAqB;IAErB,MAAM,eAAe,IAAA,2MAA0B;IAC/C,MAAM,aAAa,IAAA,8MAA6B,EAAC;IAEjD,MAAM,aAAa,YAAY;IAE/B,uCAAuC;IACvC,IAAI,aAAa,YAAY,aAAa,cAAc;QACtD,MAAM,aAAa,GAAG,aAAa,IAAI,EAAE,YAAY;QACrD,OAAO,MAAM,WAAW,QAAQ,CAAC,YAAY,QAAQ,aAAa,eAAe,iBAAiB;IACpG;IAEA,yCAAyC;IACzC,MAAM,aAAa,GAAG,aAAa,IAAI,EAAE,YAAY;IACrD,OAAO,MAAM,WAAW,QAAQ,CAAC,YAAY,QAAQ;AACvD;AAKO,eAAe,iBACpB,SAAyB,EACzB,YAAgC,EAChC,MAAc,EACd,QAAqB;IAErB,MAAM,SAAS,IAAA,oMAAmB,EAAC,WAAW;IAC9C,MAAM,aAAa,YAAY;IAE/B,IAAI,aAAa,YAAY,aAAa,cAAc;QACtD,OAAO,MAAM,WAAW,QAAQ,CAAC,QAAQ,QAAQ,aAAa,eAAe,iBAAiB;IAChG;IAEA,OAAO,MAAM,WAAW,QAAQ,CAAC,QAAQ,QAAQ;AACnD;AAKO,eAAe,uBACpB,SAAyB,EACzB,QAA4B,EAC5B,MAAc,EACd,QAAqB;IAErB,MAAM,SAAS,IAAA,0MAAyB,EAAC,WAAW;IACpD,MAAM,aAAa,YAAY;IAE/B,IAAI,aAAa,YAAY,aAAa,cAAc;QACtD,OAAO,MAAM,WAAW,QAAQ,CAAC,QAAQ,QAAQ,aAAa,eAAe,iBAAiB;IAChG;IAEA,OAAO,MAAM,WAAW,QAAQ,CAAC,QAAQ,QAAQ;AACnD;AAKO,SAAS;IACd,MAAM,WAAW,IAAA,sLAAmB;IACpC,IAAI,CAAC,UAAU;QACb,OAAO;YAAE,OAAO;YAAO,QAAQ;YAAM,UAAU;QAAK;IACtD;IAEA,MAAM,SAAS,IAAA,4KAAS,EAAC;IACzB,IAAI,CAAC,QAAQ;QACX,OAAO;YAAE,OAAO;YAAO,QAAQ;YAAM,UAAU;QAAK;IACtD;IAEA,OAAO;QAAE,OAAO;QAAM;QAAQ;IAAS;AACzC"}},
    {"offset": {"line": 817, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/shubh/OneDrive/Desktop/anisoul-forge/app/character/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { ArrowLeft, Copy, RefreshCw, CheckCircle2, Loader2 } from \"lucide-react\";\r\nimport { useCharacter } from \"@/context/CharacterContext\";\r\nimport Link from \"next/link\";\r\nimport { APIKeyModal } from \"@/components/api-key-modal\";\r\nimport { validateAPIKey, generatePersonality, generateScenario, generateInitialMessage } from \"@/lib/generation/service\";\r\nimport { isAPIKeyConnected } from \"@/lib/api-key\";\r\n\r\ntype SectionId = \"personality\" | \"scenario\" | \"initialMessage\";\r\n\r\ninterface SectionState {\r\n  loading: boolean;\r\n  error: string | null;\r\n  content: string;\r\n}\r\n\r\nexport default function CharacterResultPage() {\r\n  const params = useParams();\r\n  const router = useRouter();\r\n  const { characters, updateCharacter } = useCharacter();\r\n  const [copied, setCopied] = useState<string | null>(null);\r\n  const [showAPIKeyModal, setShowAPIKeyModal] = useState(false);\r\n  const [scenarioInput, setScenarioInput] = useState<string>(\"\");\r\n  const [showScenarioModal, setShowScenarioModal] = useState(false);\r\n  const [hasGenerated, setHasGenerated] = useState(false);\r\n\r\n  const character = characters.find((char) => char.id === params.id);\r\n\r\n  const [sections, setSections] = useState<Record<SectionId, SectionState>>({\r\n    personality: {\r\n      loading: false,\r\n      error: null,\r\n      content: character?.generatedContent?.personality || \"\",\r\n    },\r\n    scenario: {\r\n      loading: false,\r\n      error: null,\r\n      content: character?.generatedContent?.scenario || \"\",\r\n    },\r\n    initialMessage: {\r\n      loading: false,\r\n      error: null,\r\n      content: character?.generatedContent?.initialMessage || \"\",\r\n    },\r\n  });\r\n\r\n  // Check API key and generate on mount\r\n  useEffect(() => {\r\n    if (!character) return;\r\n\r\n    // Check if already generated\r\n    if (character.generatedContent?.personality) {\r\n      setSections({\r\n        personality: {\r\n          loading: false,\r\n          error: null,\r\n          content: character.generatedContent.personality || \"\",\r\n        },\r\n        scenario: {\r\n          loading: false,\r\n          error: null,\r\n          content: character.generatedContent.scenario || \"\",\r\n        },\r\n        initialMessage: {\r\n          loading: false,\r\n          error: null,\r\n          content: character.generatedContent.initialMessage || \"\",\r\n        },\r\n      });\r\n      setHasGenerated(true);\r\n      return;\r\n    }\r\n\r\n    // Check API key\r\n    if (!isAPIKeyConnected()) {\r\n      setShowAPIKeyModal(true);\r\n      return;\r\n    }\r\n\r\n    // Start generation\r\n    handleGenerateAll();\r\n  }, [character?.id]);\r\n\r\n  const handleGenerateAll = async () => {\r\n    if (!character) return;\r\n\r\n    const keyCheck = validateAPIKey();\r\n    if (!keyCheck.valid || !keyCheck.apiKey || !keyCheck.provider) {\r\n      setShowAPIKeyModal(true);\r\n      return;\r\n    }\r\n\r\n    // Generate personality first\r\n    await handleGenerateSection(\"personality\", keyCheck.apiKey, keyCheck.provider);\r\n\r\n    // Show scenario modal after personality\r\n    setShowScenarioModal(true);\r\n  };\r\n\r\n  const handleGenerateSection = async (\r\n    sectionId: SectionId,\r\n    apiKey?: string,\r\n    provider?: any\r\n  ) => {\r\n    if (!character) return;\r\n\r\n    const keyCheck = apiKey && provider ? { valid: true, apiKey, provider } : validateAPIKey();\r\n    if (!keyCheck.valid || !keyCheck.apiKey || !keyCheck.provider) {\r\n      setShowAPIKeyModal(true);\r\n      return;\r\n    }\r\n\r\n    setSections((prev) => ({\r\n      ...prev,\r\n      [sectionId]: { ...prev[sectionId], loading: true, error: null },\r\n    }));\r\n\r\n    try {\r\n      let content = \"\";\r\n\r\n      if (sectionId === \"personality\") {\r\n        content = await generatePersonality(character, keyCheck.apiKey, keyCheck.provider);\r\n      } else if (sectionId === \"scenario\") {\r\n        const userScenario = scenarioInput.trim() || undefined;\r\n        content = await generateScenario(character, userScenario, keyCheck.apiKey, keyCheck.provider);\r\n      } else if (sectionId === \"initialMessage\") {\r\n        const scenario = sections.scenario.content || undefined;\r\n        content = await generateInitialMessage(character, scenario, keyCheck.apiKey, keyCheck.provider);\r\n      }\r\n\r\n      // Update section state\r\n      setSections((prev) => ({\r\n        ...prev,\r\n        [sectionId]: { loading: false, error: null, content },\r\n      }));\r\n\r\n      // Update character context\r\n      const charIndex = characters.findIndex((c) => c.id === character.id);\r\n      if (charIndex !== -1) {\r\n        const currentContent = character.generatedContent || {};\r\n        updateCharacter(charIndex, {\r\n          generatedContent: {\r\n            ...currentContent,\r\n            [sectionId === \"personality\" ? \"personality\" : sectionId === \"scenario\" ? \"scenario\" : \"initialMessage\"]: content,\r\n          },\r\n        });\r\n      }\r\n    } catch (error: any) {\r\n      setSections((prev) => ({\r\n        ...prev,\r\n        [sectionId]: {\r\n          loading: false,\r\n          error: error.message || \"Generation failed\",\r\n          content: prev[sectionId].content,\r\n        },\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleScenarioSubmit = async () => {\r\n    setShowScenarioModal(false);\r\n    // Generate scenario\r\n    await handleGenerateSection(\"scenario\");\r\n    // Then generate initial message\r\n    setTimeout(async () => {\r\n      await handleGenerateSection(\"initialMessage\");\r\n    }, 500);\r\n  };\r\n\r\n  const handleSkipScenario = async () => {\r\n    setShowScenarioModal(false);\r\n    setScenarioInput(\"\");\r\n    // Generate scenario without user input\r\n    await handleGenerateSection(\"scenario\");\r\n    // Then generate initial message\r\n    setTimeout(async () => {\r\n      await handleGenerateSection(\"initialMessage\");\r\n    }, 500);\r\n  };\r\n\r\n  const handleRewrite = async (sectionId: SectionId) => {\r\n    await handleGenerateSection(sectionId);\r\n  };\r\n\r\n  const copyToClipboard = (text: string, section: string) => {\r\n    navigator.clipboard.writeText(text);\r\n    setCopied(section);\r\n    setTimeout(() => setCopied(null), 2000);\r\n  };\r\n\r\n  if (!character) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background flex items-center justify-center px-4\">\r\n        <div className=\"text-center\">\r\n          <p className=\"text-xl font-semibold text-foreground mb-4\">Character not found</p>\r\n          <Link\r\n            href=\"/create\"\r\n            className=\"inline-block px-6 py-3 rounded-xl bg-violet-500 hover:bg-violet-600 text-white font-medium transition-colors\"\r\n          >\r\n            Create Character\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const displaySections = [\r\n    {\r\n      id: \"personality\" as SectionId,\r\n      title: \"Personality\",\r\n      content: sections.personality.content,\r\n      loading: sections.personality.loading,\r\n      error: sections.personality.error,\r\n    },\r\n    {\r\n      id: \"scenario\" as SectionId,\r\n      title: \"Scenario\",\r\n      content: sections.scenario.content,\r\n      loading: sections.scenario.loading,\r\n      error: sections.scenario.error,\r\n    },\r\n    {\r\n      id: \"initialMessage\" as SectionId,\r\n      title: \"Initial Message\",\r\n      content: sections.initialMessage.content,\r\n      loading: sections.initialMessage.loading,\r\n      error: sections.initialMessage.error,\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background px-4 py-8\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <Link\r\n            href=\"/wizard\"\r\n            className=\"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-6\"\r\n          >\r\n            <ArrowLeft className=\"w-5 h-5\" />\r\n            <span className=\"text-sm\">Back to Wizard</span>\r\n          </Link>\r\n          <h1 className=\"text-4xl font-bold text-foreground mb-2\">{character.basics.name}</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            {character.basics.setting} • {character.basics.age} years old\r\n          </p>\r\n        </div>\r\n\r\n        {/* Character Sections */}\r\n        <div className=\"space-y-6\">\r\n          {displaySections.map((section, index) => (\r\n            <motion.div\r\n              key={section.id}\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: index * 0.1 }}\r\n              className=\"glass rounded-2xl p-6 border border-border\"\r\n            >\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <h2 className=\"text-xl font-semibold text-foreground\">{section.title}</h2>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    onClick={() => copyToClipboard(section.content || \"\", section.id)}\r\n                    disabled={!section.content || section.loading}\r\n                    className=\"px-3 py-1.5 rounded-lg glass border border-border hover:bg-white/5 transition-colors flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    {copied === section.id ? (\r\n                      <>\r\n                        <CheckCircle2 className=\"w-4 h-4 text-green-400\" />\r\n                        Copied!\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Copy className=\"w-4 h-4\" />\r\n                        Copy\r\n                      </>\r\n                    )}\r\n                  </button>\r\n                  <button\r\n                    onClick={() => handleRewrite(section.id)}\r\n                    disabled={section.loading}\r\n                    className=\"px-3 py-1.5 rounded-lg glass border border-border hover:bg-white/5 transition-colors flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    {section.loading ? (\r\n                      <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                    ) : (\r\n                      <RefreshCw className=\"w-4 h-4\" />\r\n                    )}\r\n                    Rewrite\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {section.loading ? (\r\n                <div className=\"flex items-center justify-center py-12\">\r\n                  <Loader2 className=\"w-6 h-6 animate-spin text-violet-400\" />\r\n                  <span className=\"ml-3 text-muted-foreground\">Generating...</span>\r\n                </div>\r\n              ) : section.error ? (\r\n                <div className=\"py-4 px-4 rounded-xl bg-red-500/10 border border-red-500/30\">\r\n                  <p className=\"text-sm text-red-400\">{section.error}</p>\r\n                  <button\r\n                    onClick={() => handleRewrite(section.id)}\r\n                    className=\"mt-2 text-xs text-red-400 hover:text-red-300 underline\"\r\n                  >\r\n                    Try again\r\n                  </button>\r\n                </div>\r\n              ) : (\r\n                <textarea\r\n                  value={section.content}\r\n                  onChange={(e) => {\r\n                    const charIndex = characters.findIndex((c) => c.id === character.id);\r\n                    if (charIndex !== -1) {\r\n                      const currentContent = character.generatedContent || {};\r\n                      updateCharacter(charIndex, {\r\n                        generatedContent: {\r\n                          ...currentContent,\r\n                          [section.id === \"personality\" ? \"personality\" : section.id === \"scenario\" ? \"scenario\" : \"initialMessage\"]: e.target.value,\r\n                        },\r\n                      });\r\n                    }\r\n                    setSections((prev) => ({\r\n                      ...prev,\r\n                      [section.id]: { ...prev[section.id], content: e.target.value },\r\n                    }));\r\n                  }}\r\n                  className=\"w-full min-h-32 px-4 py-3 rounded-xl glass border border-border focus:border-violet-500 transition-all outline-none resize-y text-sm font-mono\"\r\n                  placeholder={section.content ? \"\" : \"Content will be generated here...\"}\r\n                />\r\n              )}\r\n            </motion.div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"mt-8 flex gap-4\">\r\n          <Link\r\n            href=\"/create\"\r\n            className=\"flex-1 py-4 rounded-2xl glass border border-border hover:bg-white/5 transition-colors text-center font-medium\"\r\n          >\r\n            Create Another\r\n          </Link>\r\n          <button\r\n            onClick={() => router.push(\"/wizard\")}\r\n            className=\"flex-1 py-4 rounded-2xl bg-violet-500 hover:bg-violet-600 text-white font-semibold transition-colors\"\r\n          >\r\n            Edit Character\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* API Key Modal */}\r\n      <APIKeyModal\r\n        isOpen={showAPIKeyModal}\r\n        onClose={() => setShowAPIKeyModal(false)}\r\n        onSave={() => {\r\n          setShowAPIKeyModal(false);\r\n          if (!hasGenerated) {\r\n            handleGenerateAll();\r\n          }\r\n        }}\r\n      />\r\n\r\n      {/* Scenario Modal */}\r\n      {showScenarioModal && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n          <div\r\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm\"\r\n            onClick={() => setShowScenarioModal(false)}\r\n          />\r\n          <motion.div\r\n            initial={{ opacity: 0, scale: 0.95 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            className=\"glass rounded-3xl p-8 max-w-2xl w-full border border-border relative z-10\"\r\n          >\r\n            <h2 className=\"text-2xl font-bold text-foreground mb-4\">Define Scenario (Optional)</h2>\r\n            <p className=\"text-muted-foreground mb-6\">\r\n              You can provide a custom scenario or let AI generate one based on your character.\r\n            </p>\r\n            <textarea\r\n              value={scenarioInput}\r\n              onChange={(e) => setScenarioInput(e.target.value)}\r\n              placeholder=\"e.g., The character is in a coffee shop, waiting for someone. It's raining outside...\"\r\n              className=\"w-full h-32 px-4 py-3 rounded-xl glass border border-border focus:border-violet-500 transition-all outline-none resize-none mb-6\"\r\n            />\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={handleSkipScenario}\r\n                className=\"flex-1 py-3 rounded-xl glass border border-border hover:bg-white/5 transition-colors font-medium\"\r\n              >\r\n                Skip (AI Generate)\r\n              </button>\r\n              <button\r\n                onClick={handleScenarioSubmit}\r\n                className=\"flex-1 py-3 rounded-xl bg-violet-500 hover:bg-violet-600 text-white font-medium transition-colors\"\r\n              >\r\n                Continue\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}